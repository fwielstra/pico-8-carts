pico-8 cartridge // http://www.pico-8.com
version 18
__lua__
-- adventure map demo / poc
function _init()
 p={
  --pos in cels
  x=2,
  y=4,
  s=3,
  g=0
 }
 --current mpa
 m={
  x=0,
  y=0
 }
end

function _update()
 --deltas, intended updates
 --detect collision before
 --applying
 local dx=0
 local dy=0
 if (btnp(0)) dx=-1
 if (btnp(1)) dx=1
 if (btnp(2)) dy=-1
 if (btnp(3)) dy=1
 
 --detect wall
 tspr=mget(p.x+dx,p.y+dy)
 if not fget(tspr,0) then
  p.x+=dx
  p.y+=dy
  if dx!=0 or dy != 0 then
   sfx(1)
  end
 end
 
 --detect chest
 if fget(tspr,1) then
  p.g+=100
  sfx(0)
  mset(p.x,p.y,1)
 end
 
 --map transition
 m.x=flr(p.x/16)
 m.y=flr(p.y/8)
end

function _draw()
 cls()
 --draw current map section
 map(m.x*16,m.y*8,0,0,48,8)
 -- todo: gui or fullscreen map
 --draw player relative to map
 spr(p.s,(p.x%16)*8,(p.y%8)*8)
 print("gold: "..p.g,5,5)
end

__gfx__
0000000033333b334944494400999900333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000003b3333334944494409999990333443330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700333333339999999909f1ff10334444330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000333333334449444949fffff0344444430000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700033b33333444944490ccccccc399999930000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070033333b3399999999f0cccc0f344aa4430000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000333333334944494400c00c00344444430000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000333333334944494400f00f00344444430000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000010002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0201010101010101010101010101010202010101010101010101010101010101010101010101010101010101010101020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0201010101010101010101010101010202010101010201010101040101010102020101010101020202020102010101020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0201010101010101010101010101010202010101010201010101010101010102020101010101020104020102010101020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0201010101010101010101040101010101010101010201010101010101010102020101010101020102020102010101020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0201010101010101010101010101010101010101010201010101040101010102020101010101020101010102010101020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0201010101010101010101010101010202010101010101010101010101010101010101010101020202020202010101020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020201010202020202020202020202020202020202020202020202020202020202020202020202020201020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020201010202020202020202020202020202020202020202020202020202020202020202020202020201020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0201010101010101010101010101010202010101010101010101010101010102020101010101010101010101010101020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0201010101010101010101010101010202010101010101010101010101010102020101010101010101010101010101020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0201010101010101010101010101010202010101010101010101010101010102020101010101010101010202010101020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0201010101010101010101010101010202010101010101010101010101010101010101010101010101010204010101020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0201010101010101010101010101010101010101010101010101010101010101010101010101010101010202010101020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0201010101010101010101010101010101010101010101010101010101010102020101010101010101010101010101020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000700002e5502e400355500000000000000003200032000350000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000900000a05003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
